import React, { useContext } from 'react';
import AppBar from '@mui/material/AppBar';
import Box from '@mui/material/Box';
import CssBaseline from '@mui/material/CssBaseline';
import Drawer from '@mui/material/Drawer';
import Head from 'next/head'
import { NavBarContent } from './NavBarContent'
import { SideBarContent } from './SideBarContent';
import { MainContent } from './MainContent';
import { Alert, Snackbar, Stack, useTheme } from '@mui/material';
import { AlertContext, AuthContext, LoadingContext } from '../../contexts';
import { LoadingTransaction } from '../util';
const drawerWidth = 240;




export const Layout: React.FC<{}> = (props) => {
    const { children } = props;
    const { currentUser } = useContext(AuthContext)
    const { alert, setAlert } = useContext(AlertContext)

    return (
        <>
            <Head>
                <title>ERP</title>
                <meta name="description" content="Generated by create next app" />
                <link rel="icon" href="/favicon.ico" />
            </Head>
            <LoadingTransaction />
            {
                <Snackbar
                    open={Boolean(alert?.message)}
                    autoHideDuration={15000}
                    onClose={() => setAlert({ status: "info", message: "" })}
                    anchorOrigin={{ vertical: "top", horizontal: "center" }}
                >
                    <Alert severity={alert?.status} onClose={() => setAlert({ status: "info", message: "" })}>{alert?.message}</Alert>
                </Snackbar>
            }
            {currentUser === null ?

                <div>
                    {children}
                </div>
                :
                <Stack direction="row">
                    <Box
                        component="nav"
                        sx={{ width: drawerWidth, flexShrink: 0 }}
                        aria-label="mailbox folders"

                    >
                        {/* The implementation can be swapped with js to avoid SEO duplication of links. */}

                        <Drawer
                            variant="permanent"
                            sx={{
                                '& .MuiDrawer-paper': { boxSizing: 'border-box', width: drawerWidth },
                            }}
                            open
                        >
                            <SideBarContent />
                        </Drawer>
                    </Box>
                    <Stack flexGrow={1}>
                        <AppBar
                            position="fixed"
                            sx={{
                                width:  `calc(100% - ${drawerWidth}px)`,
                                right:0,
                                height: 64,
                            }}
                        >
                            <NavBarContent />
                        </AppBar>

                        <Box
                            component="main"
                            sx={{ flexGrow: 1, width: '100%',marginTop:8 }}
                        >
                            <MainContent>
                                {children}
                            </MainContent>
                        </Box>
                    </Stack>





                </Stack>

            }



        </>
    );
}



